layui.define(["jquery","laytpl","layer","jqelem","tabmenu"],function(i){function e(){var i=n(".menu-type").find("i"),e=document.documentElement.clientWidth;e<750?(n(".jqadmin-main-menu").hide(),n("body").addClass("left-miss left-off minWidth"),n(".jqadmin-main-menu .layui-nav .layui-nav-item a span").show(),n("#submenu").find("ul li").find("a").off("mouseenter"),n(".layui-header .header-right .right-menu").hide()):e<970?(n(".jqadmin-main-menu").show(),n(".jqadmin-main-menu .layui-nav .layui-nav-item a span").hide(),n(".layui-header .header-right .right-menu").show(),n("body").removeClass("left-miss minWidth"),n("body").addClass("left-off"),n("#submenu").find("ul li").children("a").each(function(){n(this).addClass("nav-collapse")}),n("#submenu").find("ul li").find("a").on("mouseenter",function(){s.tips(n(this).data("title"),n(this))}),n("#submenu").find("ul li").find("a").on("mouseleave",function(){s.closeAll("tips")}),i.html("&#xe683;"),n(".jqadmin-main-menu .cloneDom").remove(),o=!1):(n(".jqadmin-main-menu").show(),n(".jqadmin-main-menu .layui-nav .layui-nav-item a span").show(),n(".layui-header .header-right .right-menu").show(),n("body").removeClass("left-off minWidth left-miss"),n("#submenu").find("ul li").find("a").off("mouseenter").removeClass("nav-collapse"),i.html("&#xe61a;"),n(".jqadmin-main-menu .cloneDom").remove(),o=!1)}var n=layui.jquery,t=layui.laytpl,a=layui.jqelem,s=layui.layer,l=!0,o=!1,m=layui.tabmenu(),d=function(){this.options={showIcon:!0}};d.prototype.init=function(){this.openOldMenu(),this.resize(),this.menuBind(),a.init(),m.effect(0),n("iframe[data-id=0]").length>0&&n("iframe[data-id=0]").attr("src",n("[lay-id=0]").find("em").data("href"))},d.prototype.tabmenu=m,d.prototype.resize=function(){n(window).on("resize",function(){m.init(),m.tabMove(0,1)}).resize()},d.prototype.menuBind=function(){var i=this,e=n("#menu");n(".sub-menu").eq(0).slideDown(),e.find("li").removeClass("layui-this").eq(0).addClass("layui-this"),e.find("a").on("mouseenter",function(){s.tips(n(this).data("title"),n(this),{tips:3})}).on("mouseleave",function(){s.closeAll("tips")}),n(".sub-menu .layui-nav-item,.tab-menu,.menu-list li").bind("click",function(){var e=n(this);n(".menu-list").slideUp(),n(".tab-move-btn").removeClass("open").find("i").html("&#xe604;"),e.find("dl").length<=0&&i.menuSetOption(e)}).find("dd").bind("click",function(){i.menuSetOption(n(this))}),a.on("nav(main-menu)",function(i){var e=i.index();-1==i[0].className.indexOf("tab-menu")&&n(".sub-menu").slideUp().eq(e).slideDown()}),n(".tab-move-btn").bind("click",function(){"none"==n(".menu-list").css("display")?(n(this).addClass("open"),i.menulist(),n(".menu-list li").bind("click",function(){i.menuSetOption(n(this))}),n(".menu-list").slideDown("fast"),n(this).find("i").html("&#xe603;")):(n(this).removeClass("open"),n(".menu-list").slideUp("fast"),n(this).find("i").html("&#xe604;"))}),n("span.move-left-btn,span.move-right-btn").bind("selectstart",function(){return!1})},d.prototype.menuSetOption=function(i){var e=i.children("a"),n=e.data("url"),t=e.children("i:first").data("icon")||"&#xe621;",a=e.data("title"),s={href:n,icon:t,cls:e.children("i:first").get(0).className,title:a};this.menuOpen(s)},d.prototype.menuOpen=function(i){m.tabAdd(i,this.options.fresh)},d.prototype.openOldMenu=function(){a.on("tab(tabmenu)",function(){var i=n(this).attr("lay-id");n(".menu-list").slideUp(),n(".tab-move-btn").removeClass("open").find("i").html("&#xe604;");var e={layId:i};l||m.storage(e,"change"),n(this).attr("fresh")&&(n(this).removeAttr("fresh"),m.fresh(i))});var i=window.sessionStorage,e=navigator.userAgent;if(i.menu){var t=i.menu;t=t.split("|");for(index in t)if("remove"!=index){if("string"==typeof t[index])var s=JSON.parse(t[index]);s.nodo=!0,e.indexOf("Firefox")>=0&&(s.old=!0),this.menuOpen(s)}}if(i.curMenu&&"undefined"!==i.curMenu){"string"==typeof(s=i.curMenu)&&(s=JSON.parse(s)),e.indexOf("Firefox")>=0&&(s.old=!0),this.menuOpen(s)}l=!1},d.prototype.menulist=function(){if(i=window.sessionStorage.menu){var i=i.split("|"),e=[],a={};for(index in i)if("remove"!=index){if("string"==typeof i[index])var s=JSON.parse(i[index]);e.push(s)}if(a.list=e,""!=a||void 0!=a){var l=n("#menu-list-tpl").html();t(l).render(a,function(i){n("#menu-list").html(i)})}}},d.prototype.menuShowType=function(i){var e=document.documentElement.clientWidth,t=0;if("close"==i&&(t=1),"open"!=i&&"close"!=i&&window.localStorage){t=window.localStorage.getItem("showType"),t=n("body").hasClass("left-off")?0:1}var a=n(".menu-type").find("i");switch(parseInt(t)){case 1:var l=n("#submenu").find("ul li");l.children("a").each(function(){n(this).addClass("nav-collapse")}),n("body").addClass("left-off").removeClass("left-miss"),l.find("a").on("mouseenter",function(){s.tips(n(this).data("title"),n(this))}).on("mouseleave",function(){s.closeAll("tips")}),this.options.showIcon||n("#submenu").find("i").removeClass("hide-icon"),a.html("&#xe683;");break;default:n("#submenu").find("ul li").find("a").off("mouseenter").removeClass("nav-collapse"),n("body").removeClass("left-off"),e<750?(n("body").removeClass("left-miss"),a.html("&#xe61a;")):a.html("&#xe61a;")}},window.onresize=e,e(),n(".minWidth li.first").click(function(i){n(".minWidth #menu .head-nav-item").removeClass("layui-this"),n("#menu li.first dl").removeClass("layui-show"),n(this).siblings(".first").find("dl").hide(),n(this).find("span").toggleClass("layui-nav-mored"),n(this).find("dl").toggle()}),n(".jqadmin-auxiliary-btn").click(function(i){if(n(this).toggleClass("xz"),!o){var e=n(".minWidth .layui-header .header-right .right-menu li").clone(!0);n(".minWidth .layui-header .header-right .right-menu").hide(),e.appendTo("#menu")}n(".minWidth .jqadmin-main-menu").slideToggle(),o=!0}),n(".minWidth .first dd").click(function(i){n(".minWidth .jqadmin-main-menu").slideUp()}),n(".minWidth .head-nav-item").click(function(i){n(".minWidth .jqadmin-main-menu").slideUp(),top.global.menu.menuShowType("open")}),n(".minWidth .tab-menu").unbind("click").click(function(i){n(".minWidth .jqadmin-main-menu").slideUp()}),i("jqmenu",d)});